(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2022],{91709:function(e,i,l){Promise.resolve().then(l.bind(l,67182))},67182:function(e,i,l){"use strict";l.r(i),l.d(i,{default:function(){return A}});var n=l(57437),r=l(2265),a=l(39343),s=l(37169),t=l(83719),o=l(76520),d=l(41448),c=l.n(d),h=(l(22960),l(86645)),u=l(74691),m=l(68884),x=l(48367),p=l(92674),f=l(27219),j=l(74067),g=l(87116),Z=l(28027),b=l(94614),v=(l(44360),l(45778),l(32679),l(40031),l(67622)),y=l(46270),N=l(44376),w=l(66858),S=l(95253),C=l(11929),k=l(48024),P=l(69065),R=(l(80824),l(7630),l(32591)),W=l(27776);let E={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:"10px",boxShadow:24,p:4};var F=e=>{var i;let{open:l,onClose:o,selectedUser:d,setRefresh:c}=e,{register:h,handleSubmit:u,setValue:m}=(0,a.cI)(void 0);r.useEffect(()=>{d&&(m("firstName",d.firstName),m("lastName",d.lastName),m("email",d.email),m("roles",d.roles),m("phone",d.phone))},[d,m]);let x=async e=>{console.log("Mise \xe0 jour de l'utilisateur :",e),await fetch("https://backoffice.ozapay.me/api/user/".concat(null==d?void 0:d.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),c(!0),W.A.success("Utilisateur mis \xe0 jours avec succ\xe8s"),setTimeout(()=>{c(!0)},100),o()};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(R.Z,{open:l,onClose:o,children:(0,n.jsxs)(s.Z,{sx:E,children:[(0,n.jsx)(t.Z,{variant:"h6",component:"h2",children:"Modifier l'utilisateur"}),(0,n.jsxs)("form",{onSubmit:u(x),children:[(0,n.jsx)(w.Z,{...h("firstName"),label:"Pr\xe9nom",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...h("lastName"),label:"Nom de famille",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...h("email"),label:"Email",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...h("roles"),label:"Roles",fullWidth:!0,margin:"normal",value:(null==d?void 0:null===(i=d.roles)||void 0===i?void 0:i.join(", "))||"",onChange:e=>m("roles",e.target.value.split(", ").map(e=>e.trim()))}),(0,n.jsx)(w.Z,{...h("phone"),label:"Num\xe9ro",fullWidth:!0,margin:"normal"}),(0,n.jsxs)(s.Z,{mt:2,display:"flex",justifyContent:"space-between",children:[(0,n.jsx)(N.Z,{onClick:o,color:"error",variant:"outlined",children:"Annuler"}),(0,n.jsx)(N.Z,{type:"submit",color:"primary",variant:"contained",children:"Mettre \xe0 jour"})]})]})]})})})};(0,k.ZP)(P.Z)(e=>{let{theme:i}=e;return{"& .MuiDialogContent-root":{padding:i.spacing(2)},"& .MuiDialogActions-root":{padding:i.spacing(1)}}});let M={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",borderRadius:"10px",boxShadow:24,p:4};function A(e){var i,l,d,c,k;let{params:{lang:P}}=e,[R,W]=(0,r.useState)([]),[E,A]=(0,r.useState)(!0),[z,T]=(0,r.useState)(!1),[U,_]=(0,r.useState)(null),[q,I]=(0,r.useState)(0),[O,D]=(0,r.useState)(10),[B,J]=(0,r.useState)(!1),[L,G]=(0,r.useState)(null),{register:H,handleSubmit:K,setValue:Q}=(0,a.cI)(void 0),V=e=>{G(e),Q("firstName",e.firstName),Q("lastName",e.lastName),Q("email",e.email),Q("roles",e.roles),Q("phone",e.phone),J(!0),console.log("-user ",e)};(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("https://backoffice.ozapay.me/api/users");if(!e.ok)throw Error("Error fetching users");let i=await e.json();W(i)}catch(e){_(e.message)}finally{A(!1)}})()},[z]);let X=q>0?Math.max(0,(1+q)*O-R["hydra:member"].length):0,Y=()=>{J(!1)},$=async e=>{await fetch("/api/users/".concat(null==L?void 0:L.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),J(!1),T(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.Z,{sx:{boxShadow:"none",borderRadius:"10px",p:"25px 20px 15px",mb:"15px"},children:[(0,n.jsxs)(s.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #EEF0F7",paddingBottom:"10px",mb:"20px"},children:[(0,n.jsx)(t.Z,{component:"h3",sx:{fontSize:18,fontWeight:500},children:"Users List"}),(0,n.jsxs)(N.Z,{onClick:()=>{J(!0)},variant:"contained",sx:{textTransform:"capitalize",borderRadius:"8px",fontWeight:"500",fontSize:"13px",padding:"12px 20px",color:"#fff !important"},children:[(0,n.jsx)(S.default,{sx:{position:"relative",top:"-1px"}})," Create New User"]})]}),(0,n.jsx)(p.Z,{component:Z.Z,sx:{boxShadow:"none"},children:(0,n.jsxs)(h.Z,{sx:{minWidth:850},"aria-label":"custom pagination table",children:[(0,n.jsx)(u.Z,{sx:{background:"#F7FAFF"},children:(0,n.jsxs)(g.Z,{children:[(0,n.jsx)(x.Z,{align:"center",children:"ID"}),(0,n.jsx)(x.Z,{align:"center",children:"Pr\xe9nom"}),(0,n.jsx)(x.Z,{align:"center",children:"Nom de famille"}),(0,n.jsx)(x.Z,{align:"right",children:"E-mail"}),(0,n.jsx)(x.Z,{align:"right",children:"Roles"}),(0,n.jsx)(x.Z,{align:"right",children:"Num\xe9ro"}),(0,n.jsx)(x.Z,{align:"right",children:"Actions"})]})}),(0,n.jsxs)(m.Z,{children:[null===(i=O>0?null===(d=R["hydra:member"])||void 0===d?void 0:null===(l=d.sort((e,i)=>e.id-i.id))||void 0===l?void 0:l.slice(q*O,q*O+O):null===(c=R["hydra:member"])||void 0===c?void 0:c.sort((e,i)=>e.id-i.id))||void 0===i?void 0:i.map(e=>(0,n.jsxs)(g.Z,{children:[(0,n.jsxs)(x.Z,{children:[(0,n.jsx)(C.Z,{size:"small"}),e.id]}),(0,n.jsx)(x.Z,{align:"center",children:e.firstName}),(0,n.jsx)(x.Z,{align:"center",children:e.lastName}),(0,n.jsx)(x.Z,{align:"center",children:e.email}),(0,n.jsx)(x.Z,{align:"center",children:e.roles}),(0,n.jsx)(x.Z,{align:"center",children:e.phone}),(0,n.jsxs)(x.Z,{align:"right",children:[(0,n.jsx)(b.Z,{color:"error",children:(0,n.jsx)(v.default,{})}),(0,n.jsx)(b.Z,{color:"primary",onClick:()=>V(e),children:(0,n.jsx)(y.default,{})})]})]},e.id)),X>0&&(0,n.jsx)(g.Z,{style:{height:53*X},children:(0,n.jsx)(x.Z,{colSpan:5})})]}),(0,n.jsx)(f.Z,{children:(0,n.jsx)(g.Z,{children:(0,n.jsx)(j.Z,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:5,count:null===(k=R["hydra:member"])||void 0===k?void 0:k.length,rowsPerPage:O,page:q,onPageChange:(e,i)=>{I(i)},onRowsPerPageChange:e=>{D(parseInt(e.target.value,10)),I(0)}})})})]})})]}),(0,n.jsx)(F,{setRefresh:T,open:B,onClose:Y,selectedUser:L,children:(0,n.jsxs)(s.Z,{sx:M,children:[(0,n.jsx)(t.Z,{variant:"h6",component:"h2",children:"Modifier l'utilisateur"}),(0,n.jsxs)("form",{onSubmit:K($),children:[(0,n.jsx)(w.Z,{...H("firstName"),label:"Pr\xe9nom",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...H("lastName"),label:"Nom de famille",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...H("email"),label:"Email",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...H("roles"),label:"Roles",fullWidth:!0,margin:"normal"}),(0,n.jsx)(w.Z,{...H("phone"),label:"Num\xe9ro",fullWidth:!0,margin:"normal"}),(0,n.jsxs)(s.Z,{mt:2,display:"flex",justifyContent:"space-between",children:[(0,n.jsx)(N.Z,{onClick:Y,color:"error",variant:"outlined",children:"Annuler"}),(0,n.jsx)(N.Z,{type:"submit",color:"primary",variant:"contained",children:"Mettre \xe0 jour"})]})]})]})})]})}c().node,c().func.isRequired,c().number.isRequired,c().func.isRequired,c().number.isRequired,c().number.isRequired}},function(e){e.O(0,[5067,3568,77,3991,5278,2363,8774,6291,15,5056,8833,6858,8002,966,1952,2971,7023,1744],function(){return e(e.s=91709)}),_N_E=e.O()}]);